<!DOCTYPE html>
<html lang="zh-CN ">
<!-- Head Start -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="kavience 的博客, 专注于前端开发, web开发, 编程技术-Mobx的学习与使用">
    <meta name="keyword"  content="kavience,javascript,前端开发,php,react,kavience博客,Mobx的学习与使用">
    <link rel="shortcut icon" href="/img/avatar/my-avatar.jpg">
    <title>
        
          Mobx的学习与使用 - kavience | Blog
        
    </title>
    <link rel="canonical" href="http://www.kavience.com/front-end/study-and-use-of-mobx.html">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/bootstrap.min.css">

    
<link rel="stylesheet" href="/css/omega.css">

    
<link rel="stylesheet" href="/css/highlight.css">

    
<link rel="stylesheet" href="/css/gitalk.min.css">

    
<link rel="stylesheet" href="/css/kkpager_orange.min.css">


    
<script src="/js/jquery.min.js"></script>

    
<script src="/js/bootstrap.min.js"></script>

    
<script src="/js/gitalk.min.js"></script>

    
<script src="/js/kkpager.min.js"></script>

    
<script src="/js/button.min.js"></script>

    
<script src="/js/fastclick.min.js"></script>

    
<script src="/js/omega.js"></script>

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/feed.xml" title="Kavience" type="application/atom+xml">
</head>

<!-- Head End -->
<body ontouchstart="">
    <!-- Header Start -->
     
        <style type="text/css">
    header.intro-header {
        
            background-image: url('/img/header_img/article-bg.jpg')
        
    }
</style>
<header id="intro-header" class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                            <a class="tag" href="/tags/mobx" title="mobx">mobx</a>
                            
                            <a class="tag" href="/tags/mobx-react" title="mobx-react">mobx-react</a>
                            
                        </div>
                        <h1>Mobx的学习与使用</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Kavience on
                            2021-03-24
                        </span>
                    </div>
                
            </div>
        </div>
    </div>
</header>

     
    <!-- Header End -->

    <!-- Nav Start -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Kavience</a>
    </div>

    <div id="blog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="#" id="search" ><img style="width: 16px;height: 16px;margin: -2px 5px 0px 0;" src="/icons/search.svg " alt="">搜索 </a>
          </li>
          <li>
            <a href="/">首页 </a>
          </li>
           

           
             
           
            
              <li>
                <a href="/categories/">分类</a>
              </li>
             
           
            
              <li>
                <a href="/tags/">标签</a>
              </li>
             
           
            
              <li>
                <a href="/archive/">归档</a>
              </li>
             
           
            
              <li>
                <a href="/about/">关于</a>
              </li>
             
          
        </ul>
      </div>
    </div>
  </div>
</nav>

<!-- Search Modal -->
<div class="modal search-modal">
  <div class="search-container">
    <div class="search-container-top">
      <img src="/icons/close.svg" alt="">
    </div>
    <input class="search-container-input" placeholder="输入关键字搜索 " type="text">
    <div class="search-container-content"></div>
  </div>
</div>

<script>
  $('.search-container').css({ "height": window.innerHeight, "overflow": 'hidden' })
  $('.search-container-content').css({ "height": window.innerHeight - 70, "overflow": 'scroll' })
  var allArticles = [];
  var xReq = new XMLHttpRequest();
  xReq.open('GET', '/search.json');
  xReq.send();
  xReq.onreadystatechange = function(){
    if(xReq.readyState === 4 && xReq.status === 200){
      allArticles = JSON.parse(xReq.responseText);
    }
  }

  $('#search').on('click', function() {
    document.body.style['overflow-y'] = 'hidden'
    $('.search-modal').addClass('modal-show');
  });
  
  $('.search-modal,.search-container-top img').on('click', function() {
    document.body.style['overflow-y'] = 'scroll';
    $('.search-modal').removeClass('modal-show');
  });
  
  $('.search-container').on('click', function(e) {
    e.stopPropagation();
  });
  
  $('.search-container-input').bind('input propertychange', function(e) {
    var searchValue = e.currentTarget.value;
    var correctArticles = allArticles.filter(article => article.content.toLowerCase().indexOf(searchValue.toLowerCase()) > -1 || article.title.toLowerCase().indexOf(searchValue.toLowerCase()) > -1)
    var articleListHtml = '';
    for (let index = 0; index < correctArticles.length; index++) {
      var article = correctArticles[index];
      article.description = article.content.replace(/<[^>]+>/g,"");
      var title = article.title, description = '';
      var searchReg = RegExp(searchValue, 'i');
      var searchRegGlobal = RegExp(searchValue, 'ig');
      if (article.title.match(searchReg)) {
        title = article.title.replaceAll(searchRegGlobal, `<span class="search-value-active">${searchValue}</span>`);
      }
      var contentMatch = article.description.match(searchReg);
      if (contentMatch) {
        description = `...${article.description.substr(contentMatch['index'], 210)}...`.replaceAll(searchRegGlobal, `<span class="search-value-active">${searchValue}</span>`);
      } else {
        description = article.description.substr(0, 200);
      }

      articleListHtml += `<div class="search-container-content_item">
        <a href="${article.url}" class="search-container-content_item-title">${title}</a>
        <div class="search-container-content_item-description">${description}</div>
      </div>`
    }

    $('.search-container-content').html(articleListHtml);
  });
  
</script>
<script>
  var $body = document.body;
  var $toggle = document.querySelector(".navbar-toggle");
  var $navbar = document.querySelector("#blog_navbar");
  var $collapse = document.querySelector(".navbar-collapse");

  $toggle.addEventListener("click", handleMagic);
  function handleMagic(e) {
    if ($navbar.className.indexOf("in") > 0) {
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function () {
        // prevent frequently toggle
        if ($navbar.className.indexOf("in") < 0) {
          $collapse.style.height = "0px";
        }
      }, 400);
    } else {
      $collapse.style.height = "auto";
      $navbar.className += " in";
    }
  }
</script>

    <!-- Nav End -->

    <!-- Main Content Start -->
    <div class="main-content content-post ">
        
<!-- Post Content Start -->
<article>
    <div class="container" style="overflow: hidden">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container post-markdown-body
            ">
                <h2 id="mobx-简介">mobx 简介</h2>
<blockquote>
<p>简单、可扩展的状态管理，相比于 redux，更轻巧，更简单，更灵活，在某些时候性能甚至更优越。</p>
</blockquote>
<p>在这里简单的记录和介绍一下 mobx 的使用。</p>
<h2 id="简单例子">简单例子</h2>
<pre><code class="highlight js"><span class="keyword">import</span> &#123; observable &#125; <span class="keyword">from</span> <span class="string">"mobx"</span>;
<span class="keyword">import</span> &#123; observer &#125; <span class="keyword">from</span> <span class="string">"mobx-react"</span>;

<span class="keyword">var</span> numStore = observable(&#123;
  num: <span class="number">1</span>,
  addNum: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;
    <span class="keyword">this</span>.num++;
  &#125;,
&#125;);

@observer
<span class="class"><span class="keyword">class</span> <span class="title">TimerView</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;
  handleAdd = <span class="function"><span class="params">()</span> =&gt;</span> &#123;
    <span class="keyword">this</span>.props.numStore.addNum();
  &#125;;

  render() &#123;
    <span class="keyword">return</span> (
      &lt;div&gt;
        &lt;span&gt; num: &#123;<span class="keyword">this</span>.props.numStore.num&#125; &lt;<span class="regexp">/span&gt;</span>
<span class="regexp">        &lt;button onClick=&#123;this.handleAdd&#125;&gt;&lt;/</span>button&gt;
      &lt;<span class="regexp">/div&gt;</span>
<span class="regexp">    );</span>
<span class="regexp">  &#125;</span>
<span class="regexp">&#125;</span>
<span class="regexp"></span>
<span class="regexp">ReactDOM.render(&lt;TimerView numStore=&#123;numStore&#125; /</span>&gt;, <span class="built_in">document</span>.body);</code></pre>
<h2 id="主要的-api">主要的 api</h2>
<h3 id="observable">observable</h3>
<p>使用：</p>
<ul>
<li>observable(value)</li>
<li>@observable classProperty = value</li>
</ul>
<p>Observable 值可以是 JS 基本数据类型、引用类型、普通对象、类实例、数组和映射。 主要作用是指定该值的是被观察的、可修改的。其装饰器写法为 <code>@observable</code>。例如</p>
<pre><code class="highlight js"><span class="keyword">import</span> &#123; observable, computed &#125; <span class="keyword">from</span> <span class="string">"mobx"</span>;

<span class="comment">// 方法1，直接使用</span>
<span class="keyword">var</span> NumStore = observable(&#123;
  num: <span class="number">1</span>,
  addNum: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;
    <span class="keyword">this</span>.num++;
  &#125;,
&#125;);

<span class="comment">// 方法二，装饰器写法</span>
<span class="class"><span class="keyword">class</span> <span class="title">NumStore</span> </span>&#123;
  @observable price = <span class="number">0</span>;
  @observable num = <span class="number">1</span>;

  @computed <span class="keyword">get</span> total() &#123;
    <span class="keyword">return</span> <span class="keyword">this</span>.price * <span class="keyword">this</span>.num;
  &#125;
&#125;</code></pre>
<h3 id="computed">computed</h3>
<p>如果任何影响计算值的值发生变化了，计算值将根据状态自动进行衍生。 计算值在大多数情况下可以被 MobX 优化的，因为它们被认为是纯函数。 例如，如果前一个计算中使用的数据没有更改，计算属性将不会重新运行。 如果某个其它计算属性或 reaction 未使用该计算属性，也不会重新运行。 在这种情况下，它将被暂停。</p>
<pre><code class="highlight js"><span class="keyword">import</span> &#123; observable, computed &#125; <span class="keyword">from</span> <span class="string">"mobx"</span>;

<span class="class"><span class="keyword">class</span> <span class="title">NumStore</span> </span>&#123;
  @observable price = <span class="number">0</span>;
  @observable num = <span class="number">1</span>;

  @computed <span class="keyword">get</span> total() &#123;
    <span class="keyword">return</span> <span class="keyword">this</span>.price * <span class="keyword">this</span>.num;
  &#125;
&#125;</code></pre>
<h3 id="autorun">autorun</h3>
<p>autorun 可以用来监听值的变化，不要把 <code>computed</code> 和 <code>autorun</code> 搞混。它们都是响应式调用的表达式，但是，如果你想响应式的产生一个可以被其它 observer 使用的值，请使用 @computed，如果你不想产生一个新值，而想要达到一个效果，请使用 autorun。 举例来说，效果是像打印日志、发起网络请求等这样命令式的副作用。</p>
<pre><code class="highlight js"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">"axios"</span>;
<span class="keyword">import</span> &#123; observable, configure, action, runInAction, autorun &#125; <span class="keyword">from</span> <span class="string">"mobx"</span>;

configure(&#123; <span class="attr">enforceActions</span>: <span class="string">"observed"</span> &#125;);

<span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Session</span> </span>&#123;
  @observable num = <span class="number">1</span>;

  <span class="keyword">constructor</span>() &#123;
    autorun(<span class="function"><span class="params">()</span> =&gt;</span> &#123;
      <span class="comment">// 每次调用 addNum / subNum都会执行此函数</span>
      <span class="built_in">console</span>.log(<span class="string">"auto log num:"</span> + <span class="keyword">this</span>.num);
    &#125;);
  &#125;

  @action addNum = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;
    <span class="built_in">console</span>.log(<span class="keyword">this</span>.num);
    <span class="keyword">this</span>.num++;
  &#125;;

  @action subNum = <span class="function"><span class="params">()</span> =&gt;</span> &#123;
    <span class="keyword">this</span>.num--;
  &#125;;
&#125;

<span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Session();</code></pre>
<h3 id="action">action</h3>
<p>用法:</p>
<ul>
<li>action(fn)</li>
<li>action(name, fn)</li>
<li>@action classMethod() {}</li>
<li>@action(name) classMethod () {}</li>
<li>@action boundClassMethod = (args) =&gt; { body }</li>
<li>@action(name) boundClassMethod = (args) =&gt; { body }</li>
<li>@action.bound classMethod() {}</li>
</ul>
<p>action 主要是用来修改状态，也可以使用异步的方法</p>
<pre><code class="highlight js"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">"axios"</span>;
<span class="keyword">import</span> &#123; observable, configure, action, runInAction &#125; <span class="keyword">from</span> <span class="string">"mobx"</span>;

<span class="comment">// 强制使用 action 来修改状态，否则会打印 waring</span>
configure(&#123; <span class="attr">enforceActions</span>: <span class="string">"observed"</span> &#125;);

<span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Session</span> </span>&#123;
  @observable num = <span class="number">1</span>;
  @observable loading = <span class="literal">false</span>;

  @action addNum = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;
    <span class="built_in">console</span>.log(<span class="keyword">this</span>.num);
    <span class="keyword">this</span>.num++;
  &#125;;

  @action subNum = <span class="function"><span class="params">()</span> =&gt;</span> &#123;
    <span class="keyword">this</span>.num--;
  &#125;;

  @action directGetHundred = <span class="function"><span class="params">()</span> =&gt;</span> &#123;
    <span class="keyword">this</span>.loading = <span class="literal">true</span>;
    setTimeout(
      <span class="comment">// 所有的修改状态都需要放在 action 中</span>
      action(<span class="string">"directAddHundred"</span>, () =&gt; &#123;
        <span class="keyword">this</span>.num += <span class="number">100</span>;
        <span class="keyword">this</span>.loading = <span class="literal">false</span>;
      &#125;),
      <span class="number">1000</span>
    );
  &#125;;

  @action directGetTwoHundred = <span class="keyword">async</span> () =&gt; &#123;
    <span class="keyword">this</span>.loading = <span class="literal">true</span>;
    <span class="keyword">await</span> axios(<span class="string">"/"</span>);
    <span class="comment">// 调用其他异步操作</span>
    <span class="comment">// await axios("/");</span>
    <span class="comment">// runInAction 是 action 的语法糖，鼓励你不要到处写 action，而是在整个过程结束时尽可能多地对所有状态进行修改</span>
    runInAction(<span class="function"><span class="params">()</span> =&gt;</span> &#123;
      <span class="keyword">this</span>.loading = <span class="literal">false</span>;
      <span class="keyword">this</span>.num += <span class="number">200</span>;
    &#125;);
  &#125;;
&#125;

<span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Session();</code></pre>
<h2 id="flows">flows</h2>
<p>flows 的工作原理与 async / await 是一样的。只是使用 function * 来代替 async，使用 yield 代替 await 。 使用 flow 的优点是它在语法上基本与 async / await 是相同的 (只是关键字不同)，并且不需要手动用 @action 来包装异步代码，这样代码更简洁。</p>
<p>flow 只能作为函数使用，不能作为装饰器使用。 flow 可以很好的与 MobX 开发者工具集成，所以很容易追踪 async 函数的过程。</p>
<pre><code class="highlight js">mobx.configure(&#123; <span class="attr">enforceActions</span>: <span class="literal">true</span> &#125;);

<span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;
  @observable githubProjects = [];
  @observable state = <span class="string">"pending"</span>;

  fetchProjects = flow(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;
    <span class="comment">// &lt;- 注意*号，这是生成器函数！</span>
    <span class="keyword">this</span>.githubProjects = [];
    <span class="keyword">this</span>.state = <span class="string">"pending"</span>;
    <span class="keyword">try</span> &#123;
      <span class="keyword">const</span> projects = <span class="keyword">yield</span> fetchGithubProjectsSomehow(); <span class="comment">// 用 yield 代替 await</span>
      <span class="keyword">const</span> filteredProjects = somePreprocessing(projects);
      <span class="comment">// 异步代码块会被自动包装成动作并修改状态</span>
      <span class="keyword">this</span>.state = <span class="string">"done"</span>;
      <span class="keyword">this</span>.githubProjects = filteredProjects;
    &#125; <span class="keyword">catch</span> (error) &#123;
      <span class="keyword">this</span>.state = <span class="string">"error"</span>;
    &#125;
  &#125;);
&#125;</code></pre>
<h2 id="总结">总结</h2>
<p>之前一直使用 redux，看到了有赞前端技术团队的 <a href="https://tech.youzan.com/mobx_vs_redux/" target="_blank" rel="noopener">我为什么从 Redux 迁移到了 Mobx<br>
</a> 文章，决定了解一下 mobx ，现在这里只记录 mobx 的简单使用，详细的还是需要查看<a href="https://cn.mobx.js.org/" target="_blank" rel="noopener">官方文档</a>。</p>

                
                <hr>
                <div class="row">
                    <div class="col-md-12 post-statement">
                        <span>作者: Kavience</span>
                        <span>本文链接: <a href="http://www.kavience.com/front-end/study-and-use-of-mobx.html">http://www.kavience.com/front-end/study-and-use-of-mobx.html </a></span>
                        <span>转载请注明:《Mobx的学习与使用》转自 http://www.kavience.com/front-end/study-and-use-of-mobx.html，原作者：Kavience </span>
                        <span><a href="https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank" rel="noopener">版权声明: 自由转载-非商用-非衍生-保持署名（创意共享3.0许可证）</a></span>
                    </div>
                    <div class="col-md-12">
                        <!-- Categories Start -->
                        <section>
                            <h5><a href="/categories/">分类 </a></h5>
                            <div class="tags">
                                
                                    <a class="tag" href="/categories/front-end" title="front-end">front-end</a>
                                
                            </div>
                        </section>
                        <!-- Categories End -->
                    </div>
                    <div class="col-md-12">
                        <!-- Tags Start -->
                        <section class="past-tags">
                            <h5><a href="/tags/">标签 </a></h5>
                            <div class="tags">
                                
                                    <a class="tag" href="/tags/mobx" title="mobx">mobx</a>
                                
                                    <a class="tag" href="/tags/mobx-react" title="mobx-react">mobx-react</a>
                                
                            </div>
                        </section>
                        <!-- Tags End -->
                    </div>
                </div>

                <hr>
                <!-- Pager Start -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/tools/rosetta-and-npm-under-apple-m1.html" data-toggle="tooltip" data-placement="top" title="Apple M1 下的 Rosetta 与 Npm">&larr; 上一篇 </a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/front-end/typescript-common-knowledge-summary.html" data-toggle="tooltip" data-placement="top" title="Typescript常见知识总结">下一篇  &rarr;</a>
                        </li>
                    
                </ul>
                <!-- Pager End -->
               
                <!-- Comment Start -->
<div class="comment">
  
      <div id="Mobx的学习与使用" class="gitalk"></div>
  
  

  
      <script>
          new Gitalk({
            clientID: `d25cda615a572205be1e`,
            clientSecret: `faa4cf10f1daea3d4701f8be90d80feb88c818ac`,
            repo: `blog`,
            owner: `kavience`,
            admin: `kavience`,
            id: 'Mobx的学习与使用',
            title: 'Mobx的学习与使用',
            distractionFreeMode: `false`,
            language: `zh-CN`
          }).render('Mobx的学习与使用');
      </script>
  

  
</div>            
<!-- Comment End -->
                
                <br>
                <!-- Comment Start -->
<div class="comment">
  
      <div id="Mobx的学习与使用" class="gitalk"></div>
  
  

  
      <script>
          new Gitalk({
            clientID: `d25cda615a572205be1e`,
            clientSecret: `faa4cf10f1daea3d4701f8be90d80feb88c818ac`,
            repo: `blog`,
            owner: `kavience`,
            admin: `kavience`,
            id: 'Mobx的学习与使用',
            title: 'Mobx的学习与使用',
            distractionFreeMode: `false`,
            language: `zh-CN`
          }).render('Mobx的学习与使用');
      </script>
  

  
</div>            
<!-- Comment End -->
            </div>
            
            <!-- Tabe of Content -->
            
	
		<aside id="sidebar">
			<div id="toc" class="toc-article">
				<strong class="toc-title">
					目录
				</strong>
				
					<ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#mobx-简介"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">mobx 简介</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#简单例子"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">简单例子</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#主要的-api"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">主要的 api</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#observable"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">observable</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#computed"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">computed</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#autorun"><span class="toc-nav-number">3.3.</span> <span class="toc-nav-text">autorun</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#action"><span class="toc-nav-number">3.4.</span> <span class="toc-nav-text">action</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#flows"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">flows</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#总结"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">总结</span></a></li></ol>
				
			</div>
		</aside>
	


<script>
let toc = document.getElementById('toc')
if (toc != null) {
    window.addEventListener("scroll", scrollcatelogHandler);
    let tocPosition = toc.offsetTop;
    function scrollcatelogHandler(e) {
        let event = e || window.event,
            target = event.target || event.srcElement;
        let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        if (scrollTop > tocPosition - 60) {
            toc.classList.add("toc-fixed");
        } else {
            toc.classList.remove("toc-fixed");
        }
    }
}
</script>
        </div>
    </div>
</article>

    </div>
    <!-- Main Content End -->

    <span id="rocket"></span>

    <!-- Google Analytics -->
    
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-171834825-2" ></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());
            gtag("config", "UA-171834825-2");
        </script>
    

    <!-- Baidu Tongji -->
    

    <script>
        // TOC scroll
        $(".toc-nav-link").bind("click touch", function () {
            // 根据a标签的href转换为id选择器，获取id元素所处的位置
            $('html,body').animate({ scrollTop: ($($(this).attr('href')).offset().top) }, 300);
        });
    </script>
</body>
</html>
